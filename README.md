# Spring Boot Cache ç¤ºç¯„å°ˆæ¡ˆ - å’–å•¡è¨‚å–®ç³»çµ± âš¡

[![Java](https://img.shields.io/badge/Java-21-orange.svg)](https://www.oracle.com/java/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.4.5-brightgreen.svg)](https://spring.io/projects/spring-boot)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## å°ˆæ¡ˆä»‹ç´¹

æœ¬å°ˆæ¡ˆæ˜¯ä¸€å€‹å±•ç¤º **Spring Boot Cache å¿«å–æ©Ÿåˆ¶** çš„å’–å•¡è¨‚å–®ç®¡ç†ç³»çµ±ï¼Œé€éå¯¦éš›çš„æ¥­å‹™å ´æ™¯ä¾†æ¼”ç¤ºå¦‚ä½•æœ‰æ•ˆé‹ç”¨å¿«å–æŠ€è¡“æå‡æ‡‰ç”¨ç¨‹å¼æ•ˆèƒ½ã€‚ç³»çµ±å¯¦ä½œäº†å’–å•¡å•†å“ç®¡ç†å’Œè¨‚å–®è™•ç†åŠŸèƒ½ï¼Œä¸¦æ•´åˆäº† Spring Cache æŠ½è±¡å±¤ä¾†å¯¦ç¾æ™ºæ…§å¿«å–ç­–ç•¥ã€‚

- **æ ¸å¿ƒåŠŸèƒ½**ï¼šå’–å•¡å•†å“æŸ¥è©¢ã€è¨‚å–®å»ºç«‹èˆ‡ç‹€æ…‹ç®¡ç†ã€å¿«å–å„ªåŒ–
- **è§£æ±ºå•é¡Œ**ï¼šæ¸›å°‘è³‡æ–™åº«æŸ¥è©¢æ¬¡æ•¸ï¼Œæå‡é«˜é »è¨ªå•è³‡æ–™çš„å›æ‡‰é€Ÿåº¦
- **ä¸»è¦ç‰¹è‰²**ï¼šå±•ç¤º `@Cacheable`ã€`@CacheEvict` ç­‰è¨»è§£çš„å¯¦éš›æ‡‰ç”¨
- **ç›®æ¨™ä½¿ç”¨è€…**ï¼šå­¸ç¿’ Spring Boot Cache æ©Ÿåˆ¶çš„é–‹ç™¼è€…èˆ‡æ¶æ§‹å¸«

> ğŸ’¡ **ç‚ºä»€éº¼é¸æ“‡æ­¤å°ˆæ¡ˆï¼Ÿ**
> - ä»¥çœŸå¯¦æ¥­å‹™å ´æ™¯å±•ç¤ºå¿«å–è¨­è¨ˆæ¨¡å¼èˆ‡æœ€ä½³å¯¦è¸
> - æ•´åˆç¾ä»£ Java é–‹ç™¼å·¥å…·éˆï¼Œç¬¦åˆä¼æ¥­ç´šé–‹ç™¼æ¨™æº–
> - æä¾›å®Œæ•´çš„å¿«å–ç­–ç•¥å¯¦ä½œç¯„ä¾‹ï¼Œå¯ç›´æ¥æ‡‰ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒ

### ğŸ¯ å°ˆæ¡ˆç‰¹è‰²

- **æ™ºæ…§å¿«å–ç­–ç•¥**ï¼šä½¿ç”¨ Spring Cache è¨»è§£å¯¦ç¾é€æ˜åŒ–å¿«å–ç®¡ç†
- **é‡‘é¡ç²¾ç¢ºè™•ç†**ï¼šæ•´åˆ Joda Money ç¢ºä¿è²¡å‹™è¨ˆç®—çš„ç²¾ç¢ºæ€§
- **ç¾ä»£åŒ–è³‡æ–™è™•ç†**ï¼šæ¡ç”¨ Jakarta Persistence API èˆ‡ Hibernate 6.x
- **ç¨‹å¼ç¢¼ç°¡æ½”æ€§**ï¼šå¤§é‡ä½¿ç”¨ Lombok æ¸›å°‘æ¨£æ¿ç¨‹å¼ç¢¼
- **è¨˜æ†¶é«”è³‡æ–™åº«**ï¼šä½¿ç”¨ H2 Database å¿«é€Ÿå»ºç½®é–‹ç™¼èˆ‡æ¸¬è©¦ç’°å¢ƒ

## æŠ€è¡“æ£§

### æ ¸å¿ƒæ¡†æ¶
- **Spring Boot 3.4.5** - ä¸»è¦æ‡‰ç”¨æ¡†æ¶ï¼Œæä¾›è‡ªå‹•é…ç½®èˆ‡å¾®æœå‹™åŸºç¤
- **Spring Data JPA** - è³‡æ–™æŒä¹…å±¤æ¡†æ¶ï¼Œç°¡åŒ–è³‡æ–™åº«æ“ä½œ
- **Spring Cache** - å¿«å–æŠ½è±¡å±¤ï¼Œæ”¯æ´å¤šç¨®å¿«å–å¯¦ä½œ
- **Hibernate 6.x** - ORM æ¡†æ¶ï¼Œè™•ç†ç‰©ä»¶é—œè¯å°æ‡‰

### é–‹ç™¼å·¥å…·èˆ‡è¼”åŠ©
- **Lombok** - è‡ªå‹•ç”¢ç”Ÿ getter/setter ç­‰æ¨£æ¿ç¨‹å¼ç¢¼
- **Joda Money** - å°ˆæ¥­é‡‘é¡è™•ç†å‡½å¼åº«ï¼Œç¢ºä¿è²¡å‹™è¨ˆç®—ç²¾ç¢ºåº¦
- **H2 Database** - è¨˜æ†¶é«”è³‡æ–™åº«ï¼Œé©åˆé–‹ç™¼èˆ‡æ¸¬è©¦ç’°å¢ƒ
- **Maven** - å°ˆæ¡ˆå»ºç½®èˆ‡ç›¸ä¾æ€§ç®¡ç†å·¥å…·

## å°ˆæ¡ˆçµæ§‹

```
cache-demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ tw/fengqing/spring/springbucks/
â”‚   â”‚   â”‚       â”œâ”€â”€ SpringBucksApplication.java    # ä¸»ç¨‹å¼é€²å…¥é»
â”‚   â”‚   â”‚       â”œâ”€â”€ model/                         # å¯¦é«”é¡åˆ¥ (Entity)
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ BaseEntity.java          # åŸºç¤å¯¦é«” (IDã€æ™‚æˆ³)
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Coffee.java              # å’–å•¡å•†å“å¯¦é«”
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ CoffeeOrder.java         # å’–å•¡è¨‚å–®å¯¦é«”
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OrderState.java          # è¨‚å–®ç‹€æ…‹åˆ—èˆ‰
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ MoneyConverter.java      # é‡‘é¡è½‰æ›å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ repository/                   # è³‡æ–™å­˜å–å±¤ (Repository)
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ CoffeeRepository.java    # å’–å•¡å•†å“è³‡æ–™å­˜å–
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ CoffeeOrderRepository.java # è¨‚å–®è³‡æ–™å­˜å–
â”‚   â”‚   â”‚       â””â”€â”€ service/                      # æ¥­å‹™é‚è¼¯å±¤ (Service)
â”‚   â”‚   â”‚           â”œâ”€â”€ CoffeeService.java       # å’–å•¡æœå‹™ (å«å¿«å–)
â”‚   â”‚   â”‚           â””â”€â”€ CoffeeOrderService.java  # è¨‚å–®æœå‹™
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.properties            # æ‡‰ç”¨ç¨‹å¼è¨­å®š
â”‚   â”‚       â””â”€â”€ schema.sql                       # è³‡æ–™åº«çµæ§‹èˆ‡åˆå§‹è³‡æ–™
â”‚   â””â”€â”€ test/                                     # æ¸¬è©¦ç¨‹å¼ç¢¼
â”œâ”€â”€ pom.xml                                       # Maven å°ˆæ¡ˆè¨­å®š
â””â”€â”€ README.md                                     # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
```

## å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚
- **Java 21** æˆ–æ›´é«˜ç‰ˆæœ¬
- **Maven 3.6+** å»ºç½®å·¥å…·
- **IDE** (æ¨è–¦ IntelliJ IDEA æˆ– VS Code)

### å®‰è£èˆ‡åŸ·è¡Œ

1. **å…‹éš†æ­¤å€‰åº«ï¼š**
```bash
git clone https://github.com/SpringMicroservicesCourse/cache-demo.git
```

2. **é€²å…¥å°ˆæ¡ˆç›®éŒ„ï¼š**
```bash
cd cache-demo
```

3. **ç·¨è­¯å°ˆæ¡ˆï¼š**
```bash
mvn clean compile
```

4. **åŸ·è¡Œæ‡‰ç”¨ç¨‹å¼ï¼š**
```bash
mvn spring-boot:run
```

5. **è§€å¯Ÿå¿«å–æ•ˆæœï¼š**
   - æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•å¾Œæœƒè‡ªå‹•åŸ·è¡Œç¤ºç¯„ç¨‹å¼ç¢¼
   - è§€å¯Ÿ console è¼¸å‡ºï¼Œå¯çœ‹åˆ°é¦–æ¬¡æŸ¥è©¢æœƒåŸ·è¡Œ SQLï¼Œå¾ŒçºŒæŸ¥è©¢ç›´æ¥å¾å¿«å–å–å¾—
   - å¿«å–åˆ·æ–°å¾Œæœƒé‡æ–°åŸ·è¡Œ SQL æŸ¥è©¢

## é€²éšèªªæ˜

### å¿«å–é…ç½®
```java
@CacheConfig(cacheNames = "coffee")  // è¨­å®šå¿«å–åç¨±
public class CoffeeService {
    
    @Cacheable  // æ–¹æ³•çµæœæœƒè¢«å¿«å–
    public List<Coffee> findAllCoffee() {
        return coffeeRepository.findAll();
    }
    
    @CacheEvict  // æ¸…é™¤æŒ‡å®šå¿«å–
    public void reloadCoffee() {
        // è§¸ç™¼å¿«å–æ¸…é™¤ï¼Œä¸‹æ¬¡æŸ¥è©¢æœƒé‡æ–°è¼‰å…¥è³‡æ–™
    }
}
```

### è³‡æ–™åº«è¨­å®š
```properties
# application.properties ä¸»è¦è¨­å®š
spring.jpa.hibernate.ddl-auto=none          # ä¸è‡ªå‹•å»ºç«‹è³‡æ–™è¡¨
spring.jpa.properties.hibernate.show_sql=true    # é¡¯ç¤º SQL èªå¥
spring.jpa.properties.hibernate.format_sql=true  # æ ¼å¼åŒ– SQL è¼¸å‡º
```

### é‡‘é¡è™•ç†æ©Ÿåˆ¶
```java
@Convert(converter = MoneyConverter.class)  // ä½¿ç”¨è‡ªè¨‚è½‰æ›å™¨
private Money price;  // ä½¿ç”¨ Joda Money è™•ç†é‡‘é¡

// MoneyConverter å°‡ Money ç‰©ä»¶è½‰æ›ç‚ºè³‡æ–™åº«çš„ Long å‹æ…‹ (ä»¥åˆ†ç‚ºå–®ä½)
// ä¾‹å¦‚ï¼š100.50 å…ƒ â†’ 10050 åˆ†
```

## åƒè€ƒè³‡æº

- [Spring Boot Cache å®˜æ–¹æ–‡ä»¶](https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching)
- [Spring Framework Cache Abstraction](https://docs.spring.io/spring-framework/docs/current/reference/html/integration.html#cache)
- [Joda Money å®˜æ–¹æ–‡ä»¶](https://www.joda.org/joda-money/)
- [Hibernate 6.x å®˜æ–¹æ–‡ä»¶](https://hibernate.org/orm/documentation/6.4/)

## æ³¨æ„äº‹é …èˆ‡æœ€ä½³å¯¦è¸

### âš ï¸ é‡è¦æé†’

| é …ç›® | èªªæ˜ | å»ºè­°åšæ³• |
|------|------|----------|
| å¿«å–ç­–ç•¥ | é¿å…å¿«å–ç©¿é€èˆ‡é›ªå´© | è¨­å®šåˆç†çš„å¿«å–éæœŸæ™‚é–“èˆ‡å®¹éŒ¯æ©Ÿåˆ¶ |
| é‡‘é¡ç²¾ç¢ºåº¦ | é¿å…æµ®é»æ•¸è¨ˆç®—èª¤å·® | ä½¿ç”¨ Joda Money ä»¥æœ€å°å–®ä½å„²å­˜ |
| è³‡æ–™ä¸€è‡´æ€§ | å¿«å–èˆ‡è³‡æ–™åº«åŒæ­¥ | é©æ™‚ä½¿ç”¨ @CacheEvict æ¸…é™¤éæœŸå¿«å– |
| è¨˜æ†¶é«”ä½¿ç”¨ | H2 ç‚ºè¨˜æ†¶é«”è³‡æ–™åº« | æ‡‰ç”¨ç¨‹å¼é‡å•Ÿå¾Œè³‡æ–™æœƒé‡ç½® |

### ğŸ”’ æœ€ä½³å¯¦è¸æŒ‡å—

- **å¿«å–éµè¨­è¨ˆ**ï¼šä½¿ç”¨å…·æœ‰æ¥­å‹™æ„ç¾©ä¸”å”¯ä¸€çš„å¿«å–éµå€¼
- **å¿«å–ç²’åº¦**ï¼šé¸æ“‡é©ç•¶çš„å¿«å–ç²’åº¦ï¼Œé¿å…éç´°æˆ–éç²—
- **ç›£æ§æ©Ÿåˆ¶**ï¼šå»ºè­°æ•´åˆå¿«å–å‘½ä¸­ç‡ç›£æ§ï¼Œå„ªåŒ–å¿«å–ç­–ç•¥
- **ç•°å¸¸è™•ç†**ï¼šå¿«å–æ“ä½œå¤±æ•—æ™‚æ‡‰æœ‰é™ç´šè™•ç†æ©Ÿåˆ¶

## æ ¸å¿ƒç¨‹å¼ç¢¼èªªæ˜

### å¿«å–æœå‹™å¯¦ä½œ
```java
/**
 * å’–å•¡æœå‹™é¡åˆ¥ - å±•ç¤º Spring Cache çš„ä½¿ç”¨æ–¹å¼
 * ä½¿ç”¨ @CacheConfig çµ±ä¸€è¨­å®šå¿«å–åç¨±ç‚º "coffee"
 */
@CacheConfig(cacheNames = "coffee")
public class CoffeeService {
    
    /**
     * æŸ¥è©¢æ‰€æœ‰å’–å•¡å•†å“
     * @Cacheable è¨»è§£è¡¨ç¤ºæ­¤æ–¹æ³•çš„çµæœæœƒè¢«å¿«å–
     * é¦–æ¬¡èª¿ç”¨æœƒåŸ·è¡Œè³‡æ–™åº«æŸ¥è©¢ï¼Œå¾ŒçºŒèª¿ç”¨ç›´æ¥å¾å¿«å–å›å‚³
     */
    @Cacheable
    public List<Coffee> findAllCoffee() {
        return coffeeRepository.findAll();
    }
    
    /**
     * é‡æ–°è¼‰å…¥å’–å•¡è³‡æ–™
     * @CacheEvict è¨»è§£æœƒæ¸…é™¤æŒ‡å®šçš„å¿«å–
     * ä¸‹æ¬¡èª¿ç”¨ findAllCoffee() æ™‚æœƒé‡æ–°æŸ¥è©¢è³‡æ–™åº«
     */
    @CacheEvict
    public void reloadCoffee() {
        // æ­¤æ–¹æ³•ä¸»è¦ç”¨æ–¼è§¸ç™¼å¿«å–æ¸…é™¤
    }
}
```

## æˆæ¬Šèªªæ˜

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ï¼Œè©³è¦‹ LICENSE æª”æ¡ˆã€‚

## é—œæ–¼æˆ‘å€‘

æˆ‘å€‘ä¸»è¦å°ˆæ³¨åœ¨æ•æ·å°ˆæ¡ˆç®¡ç†ã€ç‰©è¯ç¶²ï¼ˆIoTï¼‰æ‡‰ç”¨é–‹ç™¼å’Œé ˜åŸŸé©…å‹•è¨­è¨ˆï¼ˆDDDï¼‰ã€‚å–œæ­¡æŠŠå…ˆé€²æŠ€è¡“å’Œå¯¦å‹™ç¶“é©—çµåˆï¼Œæ‰“é€ å¥½ç”¨åˆéˆæ´»çš„è»Ÿé«”è§£æ±ºæ–¹æ¡ˆã€‚

## è¯ç¹«æˆ‘å€‘

- **FB ç²‰çµ²é **ï¼š[é¢¨æ¸…é›²è«‡ | Facebook](https://www.facebook.com/profile.php?id=61576838896062)
- **LinkedIn**ï¼š[linkedin.com/in/chu-kuo-lung](https://www.linkedin.com/in/chu-kuo-lung)
- **YouTube é »é“**ï¼š[é›²è«‡é¢¨æ¸… - YouTube](https://www.youtube.com/channel/UCXDqLTdCMiCJ1j8xGRfwEig)
- **é¢¨æ¸…é›²è«‡ éƒ¨è½æ ¼**ï¼š[é¢¨æ¸…é›²è«‡](https://blog.fengqing.tw/)
- **é›»å­éƒµä»¶**ï¼š[fengqing.tw@gmail.com](mailto:fengqing.tw@gmail.com)

---

**ğŸ“… æœ€å¾Œæ›´æ–°ï¼š2025-06-30**  
**ğŸ‘¨â€ğŸ’» ç¶­è­·è€…ï¼šé¢¨æ¸…é›²è«‡åœ˜éšŠ** 